# -*- coding: UTF-8 -*-

import smtplib

from email.mime.multipart import MIMEMultipart
from email.mime.base import MIMEBase
from email.mime.text import MIMEText
from email.utils import COMMASPACE, formatdate
from email import Encoders
import os

#subject 标题 text 内容 files:[]
def sendMail(mailTo, mailFrom, subject, text, files, subtype='plain', server="localhost") :
    assert type(mailTo) == list
    assert type(files) == list

    msg = MIMEMultipart()
    msg['From'] = mailFrom
    msg['To'] = COMMASPACE.join(mailTo)
    msg['Date'] = formatdate(localtime=True)
    msg['Subject'] = subject

    #如果 text 是 html，则需要设置 _subtype='html'
    #默认情况下 _subtype='plain',即纯文本
    #msg.attach(MIMEText(text, _subtype='html',_charset='utf-8'))
    msg.attach(MIMEText(text, _subtype=subtype, _charset='utf-8'))

    for f in files :
        part = MIMEBase('application', "octet-stream")
        part.set_payload(open(f, "rb").read())
        Encoders.encode_base64(part)
        part.add_header('Content-Disposition', 'attachment;filename="%s"' % os.path.basename(f))
        msg.attach(part)

    smtp = smtplib.SMTP(server)
    smtp.sendmail(mailFrom, mailTo, msg.as_string())
    smtp.close()

if __name__ == '__main__' :
    text = "<!DOCTYPE html><html lang=\"en\"><head>    <meta charset=\"UTF-8\">    <title>FD&AD飞鱼海外欧洲仓每日统计报表</title></head><body><!----><span style=\"border-collapse:collapse;\">FD总发货件数占总入库件数的比例：0.01%</span><table border=\"1\" style=\"border-collapse:collapse;\">    <tbody>    <tr style=\"text-align: center;\">        <th colspan=\"9\">FD-飞鱼海外欧洲仓每日统计报表</th>    </tr>    <tr>        <th>日期</th>        <th>入库包裹数</th>        <th>入库件数(全新)</th>        <th>入库件数(二手)</th>        <th>在库库存数(商品总数)</th>        <th>发货订单数</th>        <th>发货件数</th>        <th>发占入比例</th>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">本周统计</td>        <td style=\"text-align: center;\">2456</td>        <td style=\"text-align: center;\">5020</td>        <td style=\"text-align: center;\">187</td>        <td style=\"text-align: center;\">15683</td>        <td style=\"text-align: center;\">479</td>        <td style=\"text-align: center;\">1</td>        <td style=\"text-align: center;\">0.02%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/20</td>        <td style=\"text-align: center;\">710</td>        <td style=\"text-align: center;\">1597</td>        <td style=\"text-align: center;\">71</td>        <td style=\"text-align: center;\">15683</td>        <td style=\"text-align: center;\">479</td>        <td style=\"text-align: center;\">1</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/19</td>        <td style=\"text-align: center;\">787</td>        <td style=\"text-align: center;\">1499</td>        <td style=\"text-align: center;\">72</td>        <td style=\"text-align: center;\">14086</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/18</td>        <td style=\"text-align: center;\">959</td>        <td style=\"text-align: center;\">1924</td>        <td style=\"text-align: center;\">44</td>        <td style=\"text-align: center;\">12587</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">上周统计</td>        <td style=\"text-align: center;\">3182</td>        <td style=\"text-align: center;\">5290</td>        <td style=\"text-align: center;\">277</td>        <td style=\"text-align: center;\">10663</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/17</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">10663</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/16</td>        <td style=\"text-align: center;\">425</td>        <td style=\"text-align: center;\">931</td>        <td style=\"text-align: center;\">15</td>        <td style=\"text-align: center;\">10663</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/15</td>        <td style=\"text-align: center;\">806</td>        <td style=\"text-align: center;\">1350</td>        <td style=\"text-align: center;\">88</td>        <td style=\"text-align: center;\">9732</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/14</td>        <td style=\"text-align: center;\">322</td>        <td style=\"text-align: center;\">563</td>        <td style=\"text-align: center;\">20</td>        <td style=\"text-align: center;\">8382</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/13</td>        <td style=\"text-align: center;\">724</td>        <td style=\"text-align: center;\">1056</td>        <td style=\"text-align: center;\">29</td>        <td style=\"text-align: center;\">7819</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/12</td>        <td style=\"text-align: center;\">439</td>        <td style=\"text-align: center;\">664</td>        <td style=\"text-align: center;\">62</td>        <td style=\"text-align: center;\">6763</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/11</td>        <td style=\"text-align: center;\">466</td>        <td style=\"text-align: center;\">726</td>        <td style=\"text-align: center;\">63</td>        <td style=\"text-align: center;\">6099</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">06/04-06/10</td>        <td style=\"text-align: center;\">1317</td>        <td style=\"text-align: center;\">1501</td>        <td style=\"text-align: center;\">214</td>        <td style=\"text-align: center;\">5373</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">05/28-06/03</td>        <td style=\"text-align: center;\">1201</td>        <td style=\"text-align: center;\">1143</td>        <td style=\"text-align: center;\">162</td>        <td style=\"text-align: center;\">3872</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">05/21-05/27</td>        <td style=\"text-align: center;\">651</td>        <td style=\"text-align: center;\">499</td>        <td style=\"text-align: center;\">116</td>        <td style=\"text-align: center;\">2729</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">05/14-05/20</td>        <td style=\"text-align: center;\">830</td>        <td style=\"text-align: center;\">624</td>        <td style=\"text-align: center;\">64</td>        <td style=\"text-align: center;\">2230</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">05/07-05/13</td>        <td style=\"text-align: center;\">648</td>        <td style=\"text-align: center;\">511</td>        <td style=\"text-align: center;\">100</td>        <td style=\"text-align: center;\">1606</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0%</td>    </tr>    <!-- -->    </tbody></table><!----><span style=\"border-collapse:collapse;\">AD总发货件数占总入库件数的比例：0.00%</span><table border=\"1\" style=\"border-collapse:collapse;\">    <tbody>    <tr style=\"text-align: center;\">        <th colspan=\"9\">AD-飞鱼海外欧洲仓每日统计报表</th>    </tr>    <tr>        <th>日期</th>        <th>入库包裹数</th>        <th>入库件数(全新)</th>        <th>入库件数(二手)</th>        <th>在库库存数(商品总数)</th>        <th>发货订单数</th>        <th>发货件数</th>        <th>发占入比例</th>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">本周统计</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0.00%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/20</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/19</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/18</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">上周统计</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0.00%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/17</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/16</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/15</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/14</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/13</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/12</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">2018/06/11</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\"></td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">06/04-06/10</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0.00%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">05/28-06/03</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0.00%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">05/21-05/27</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0.00%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">05/14-05/20</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0.00%</td>    </tr>    <!---->    <tr>        <td style=\"text-align: center;\">05/07-05/13</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0</td>        <td style=\"text-align: center;\">0.00%</td>    </tr>    <!-- -->    </tbody></table><!----></body></html>"
    sendMail(['924993083@qq.com'], 'MonitorBase <notify@monitor.base>', 'Send Mail', text,[],'html')